---
title: 針對適用于 Linux 的 Windows 子系統進行疑難排解
description: 提供在適用于 Linux 的 Windows 子系統上執行 Linux 時, 常見錯誤和使用者遇到之問題的詳細資訊。
keywords: BashOnWindows、bash、wsl、windows、windowssubsystem、ubuntu
author: scooley
ms.author: scooley
ms.date: 11/15/2017
ms.topic: article
ms.assetid: 6753f1b2-200e-49cc-93a5-4323e1117246
ms.custom: seodec18
ms.openlocfilehash: 0c84fb710eca1b0ffabe437f98d5c17edbd6ea39
ms.sourcegitcommit: ead64b13501d6cb7170adafbb5624f4984a0af16
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 06/21/2019
ms.locfileid: "67307641"
---
# <a name="troubleshooting-windows-subsystem-for-linux"></a><span data-ttu-id="a1f0b-104">適用于 Linux 的 Windows 子系統疑難排解</span><span class="sxs-lookup"><span data-stu-id="a1f0b-104">Troubleshooting Windows Subsystem for Linux</span></span>

### <a name="bash-loses-network-connectivity-once-connected-to-a-vpn"></a><span data-ttu-id="a1f0b-105">Bash 連接到 VPN 之後, 會失去網路連線能力</span><span class="sxs-lookup"><span data-stu-id="a1f0b-105">Bash loses network connectivity once connected to a VPN</span></span>

<span data-ttu-id="a1f0b-106">如果在連接到 Windows 上的 VPN 之後, bash 會失去網路連線, 請從 bash 內嘗試這個因應措施。</span><span class="sxs-lookup"><span data-stu-id="a1f0b-106">If after connecting to a VPN on Windows, bash loses network connectivity, try this workaround from within bash.</span></span> <span data-ttu-id="a1f0b-107">這個因應措施可讓您透過`/etc/resolv.conf`手動覆寫 DNS 解析。</span><span class="sxs-lookup"><span data-stu-id="a1f0b-107">This workaround will allow you to manually override the DNS resolution through `/etc/resolv.conf`.</span></span>

1. <span data-ttu-id="a1f0b-108">記下 VPN 的 DNS 伺服器, 使其無法執行`ipconfig.exe /all`</span><span class="sxs-lookup"><span data-stu-id="a1f0b-108">Take a note of the DNS server of the VPN from doing `ipconfig.exe /all`</span></span>
2. <span data-ttu-id="a1f0b-109">建立現有 resolv.conf 的複本`sudo cp /etc/resolv.conf /etc/resolv.conf.new`</span><span class="sxs-lookup"><span data-stu-id="a1f0b-109">Make a copy of the existing resolv.conf `sudo cp /etc/resolv.conf /etc/resolv.conf.new`</span></span>
3. <span data-ttu-id="a1f0b-110">取消連結目前的 resolv.conf`sudo unlink /etc/resolv.conf`</span><span class="sxs-lookup"><span data-stu-id="a1f0b-110">Unlink the current resolv.con `sudo unlink /etc/resolv.conf`</span></span>
4. `sudo mv /etc/resolv.conf.new /etc/resolv.conf`
5. <span data-ttu-id="a1f0b-111">開啟`/etc/resolv.conf`和</span><span class="sxs-lookup"><span data-stu-id="a1f0b-111">Open `/etc/resolv.conf` and</span></span> <br/>
   <span data-ttu-id="a1f0b-112">a.</span><span class="sxs-lookup"><span data-stu-id="a1f0b-112">a.</span></span> <span data-ttu-id="a1f0b-113">刪除檔案中的第一行, 這會顯示\# 「此檔案由 WSL 自動產生。</span><span class="sxs-lookup"><span data-stu-id="a1f0b-113">Delete the first line from the file, which says "\# This file was automatically generated by WSL.</span></span> <span data-ttu-id="a1f0b-114">若要停止自動產生此檔案, 請移除這一行。」。</span><span class="sxs-lookup"><span data-stu-id="a1f0b-114">To stop automatic generation of this file, remove this line.".</span></span> <br/>
   <span data-ttu-id="a1f0b-115">b.</span><span class="sxs-lookup"><span data-stu-id="a1f0b-115">b.</span></span> <span data-ttu-id="a1f0b-116">將上述 (1) 中的 DNS 專案新增為 DNS 伺服器清單中的第一個專案。</span><span class="sxs-lookup"><span data-stu-id="a1f0b-116">Add the DNS entry from (1) above as the very first entry in the list of DNS servers.</span></span> <br/>
   <span data-ttu-id="a1f0b-117">c.</span><span class="sxs-lookup"><span data-stu-id="a1f0b-117">c.</span></span> <span data-ttu-id="a1f0b-118">關閉檔案。</span><span class="sxs-lookup"><span data-stu-id="a1f0b-118">Close the file.</span></span> <br/>

<span data-ttu-id="a1f0b-119">當您中斷連線 VPN 之後, 您必須將變更還原到`/etc/resolv.conf`。</span><span class="sxs-lookup"><span data-stu-id="a1f0b-119">Once you have disconnected the VPN, you will have to revert the changes to `/etc/resolv.conf`.</span></span> <span data-ttu-id="a1f0b-120">若要這麼做, 請執行:</span><span class="sxs-lookup"><span data-stu-id="a1f0b-120">To do this, do:</span></span>
1. `cd /etc`
2. `sudo mv resolv.conf resolv.conf.new`
3. `sudo ln -s ../run/resolvconf/resolv.conf resolv.conf`

### <a name="starting-wsl-or-installing-a-distribution-returns-an-error-code"></a><span data-ttu-id="a1f0b-121">啟動 WSL 或安裝散發會傳回錯誤代碼</span><span class="sxs-lookup"><span data-stu-id="a1f0b-121">Starting WSL or installing a distribution returns an error code</span></span>

<span data-ttu-id="a1f0b-122">請遵循[這些指示](https://github.com/Microsoft/WSL/blob/master/CONTRIBUTING.md#8-detailed-logs)來收集詳細記錄, 並在我們的 GitHub 上提出問題。</span><span class="sxs-lookup"><span data-stu-id="a1f0b-122">Follow [these instructions](https://github.com/Microsoft/WSL/blob/master/CONTRIBUTING.md#8-detailed-logs) to collect detailed logs and file an issue on our GitHub.</span></span>

### <a name="updating-bash-on-ubuntu-on-windows"></a><span data-ttu-id="a1f0b-123">更新 Windows 上 Ubuntu 上的 Bash</span><span class="sxs-lookup"><span data-stu-id="a1f0b-123">Updating Bash on Ubuntu on Windows</span></span>

<span data-ttu-id="a1f0b-124">Windows 上的 Ubuntu 有兩個可能需要更新的元件。</span><span class="sxs-lookup"><span data-stu-id="a1f0b-124">There are two components of Bash on Ubuntu on Windows that can require updating.</span></span> 

1. <span data-ttu-id="a1f0b-125">適用于 Linux 的 Windows 子系統</span><span class="sxs-lookup"><span data-stu-id="a1f0b-125">The Windows Subsystem for Linux</span></span>
  
   <span data-ttu-id="a1f0b-126">在 Windows 上的 Ubuntu 上升級 Bash 的這個部分, 將會啟用[版本](https://msdn.microsoft.com/en-us/commandline/wsl/release_notes)資訊中的任何新修正程式概述。</span><span class="sxs-lookup"><span data-stu-id="a1f0b-126">Upgrading this portion of Bash on Ubuntu on Windows will enable any new fixes outlines in the [release notes](https://msdn.microsoft.com/en-us/commandline/wsl/release_notes).</span></span> <span data-ttu-id="a1f0b-127">請確定您已訂閱 Windows 測試人員方案, 且您的組建是最新的。</span><span class="sxs-lookup"><span data-stu-id="a1f0b-127">Ensure that you are subscribed to the Windows Insider Program and that your build is up to date.</span></span> <span data-ttu-id="a1f0b-128">如需更精細的控制, 包括重設您的 Ubuntu 實例, 請參閱[命令參考頁面](https://msdn.microsoft.com/en-us/commandline/wsl/reference)。</span><span class="sxs-lookup"><span data-stu-id="a1f0b-128">For finer grain control including resetting your Ubuntu instance check out the [command reference page](https://msdn.microsoft.com/en-us/commandline/wsl/reference).</span></span>

2. <span data-ttu-id="a1f0b-129">Ubuntu 使用者二進位檔</span><span class="sxs-lookup"><span data-stu-id="a1f0b-129">The Ubuntu user binaries</span></span> 

   <span data-ttu-id="a1f0b-130">在 Windows 上的 Ubuntu 上升級此部分的 Bash, 將會安裝 Ubuntu 使用者二進位檔的任何更新, 包括您透過 apt-get 所安裝的應用程式。</span><span class="sxs-lookup"><span data-stu-id="a1f0b-130">Upgrading this portion of Bash on Ubuntu on Windows will install any updates to the Ubuntu user binaries including applications that you have installed via apt-get.</span></span> <span data-ttu-id="a1f0b-131">若要更新, 請在 Bash 中執行下列命令:</span><span class="sxs-lookup"><span data-stu-id="a1f0b-131">To update run the following commands in Bash:</span></span>
  
   1. `apt-get update`
   2. `apt-get upgrade`
  
### <a name="apt-get-upgrade-errors"></a><span data-ttu-id="a1f0b-132">Apt-取得升級錯誤</span><span class="sxs-lookup"><span data-stu-id="a1f0b-132">Apt-get upgrade errors</span></span>
<span data-ttu-id="a1f0b-133">有些套件會使用我們尚未實行的功能。</span><span class="sxs-lookup"><span data-stu-id="a1f0b-133">Some packages use features that we haven't implemented yet.</span></span> <span data-ttu-id="a1f0b-134">`udev`例如, 尚不支援, 而且會導致數`apt-get upgrade`個錯誤。</span><span class="sxs-lookup"><span data-stu-id="a1f0b-134">`udev`, for example, isn't supported yet and causes several `apt-get upgrade` errors.</span></span>

<span data-ttu-id="a1f0b-135">若要修正與相關`udev`的問題, 請遵循下列步驟:</span><span class="sxs-lookup"><span data-stu-id="a1f0b-135">To fix issues related to `udev`, follow the following steps:</span></span>

1. <span data-ttu-id="a1f0b-136">將下列`/usr/sbin/policy-rc.d`程式寫入並儲存您的變更。</span><span class="sxs-lookup"><span data-stu-id="a1f0b-136">Write the following to `/usr/sbin/policy-rc.d` and save your changes.</span></span>
  
   ``` BASH
   #!/bin/sh
   exit 101
   ```
  
2. <span data-ttu-id="a1f0b-137">將執行許可權新增至`/usr/sbin/policy-rc.d`</span><span class="sxs-lookup"><span data-stu-id="a1f0b-137">Add execute permissions to `/usr/sbin/policy-rc.d`</span></span>
   ``` BASH
   chmod +x /usr/sbin/policy-rc.d
   ```
  
3. <span data-ttu-id="a1f0b-138">執行下列命令</span><span class="sxs-lookup"><span data-stu-id="a1f0b-138">Run the following commands</span></span>
   ``` BASH
   dpkg-divert --local --rename --add /sbin/initctl
   ln -s /bin/true /sbin/initctl
   ```
  
### <a name="error-0x80040306-on-installation"></a><span data-ttu-id="a1f0b-139">"Error:0x80040306 "安裝時</span><span class="sxs-lookup"><span data-stu-id="a1f0b-139">"Error: 0x80040306" on installation</span></span>
<span data-ttu-id="a1f0b-140">這與我們不支援舊版主控台的事實有關。</span><span class="sxs-lookup"><span data-stu-id="a1f0b-140">This has to do with the fact that we do not support legacy console.</span></span>
<span data-ttu-id="a1f0b-141">若要關閉舊版主控台:</span><span class="sxs-lookup"><span data-stu-id="a1f0b-141">To turn off legacy console:</span></span>

1. <span data-ttu-id="a1f0b-142">開啟 cmd.exe</span><span class="sxs-lookup"><span data-stu-id="a1f0b-142">Open cmd.exe</span></span>
1. <span data-ttu-id="a1f0b-143">以滑鼠右鍵按一下標題列-> 屬性-> 取消核取 [使用舊版主控台]</span><span class="sxs-lookup"><span data-stu-id="a1f0b-143">Right click title bar -> Properties -> Uncheck Use legacy console</span></span>
1. <span data-ttu-id="a1f0b-144">按一下 [確定]</span><span class="sxs-lookup"><span data-stu-id="a1f0b-144">Click OK</span></span>

### <a name="error-0x80040154-after-windows-update"></a><span data-ttu-id="a1f0b-145">"Error:0x80040154 "Windows update 之後</span><span class="sxs-lookup"><span data-stu-id="a1f0b-145">"Error: 0x80040154" after Windows update</span></span>
<span data-ttu-id="a1f0b-146">適用于 Linux 的 Windows 子系統功能可能會在 Windows 更新期間停用。</span><span class="sxs-lookup"><span data-stu-id="a1f0b-146">The Windows Subsystem for Linux feature may be disabled during a Windows update.</span></span> <span data-ttu-id="a1f0b-147">如果發生這種情況, 則必須重新啟用 Windows 功能。</span><span class="sxs-lookup"><span data-stu-id="a1f0b-147">If this happens the Windows feature must be re-enabled.</span></span> <span data-ttu-id="a1f0b-148">如需如何啟用適用于 Linux 的 Windows 子系統的指示, 請參閱[安裝指南](https://msdn.microsoft.com/en-us/commandline/wsl/install_guide#enable-the-windows-subsystem-for-linux-feature-gui https://msdn.microsoft.com/en-us/commandline/wsl/install_guide#enable-the-windows-subsystem-for-linux-feature-gui)。</span><span class="sxs-lookup"><span data-stu-id="a1f0b-148">Instructions for enabling the Windows Subsystem for Linux can be found in the [Installation Guide](https://msdn.microsoft.com/en-us/commandline/wsl/install_guide#enable-the-windows-subsystem-for-linux-feature-guihttps://msdn.microsoft.com/en-us/commandline/wsl/install_guide#enable-the-windows-subsystem-for-linux-feature-gui).</span></span>

### <a name="changing-the-display-language"></a><span data-ttu-id="a1f0b-149">變更顯示語言</span><span class="sxs-lookup"><span data-stu-id="a1f0b-149">Changing the display language</span></span>
<span data-ttu-id="a1f0b-150">WSL install 會嘗試自動變更 Ubuntu 地區設定, 以符合 Windows 安裝的地區設定。</span><span class="sxs-lookup"><span data-stu-id="a1f0b-150">WSL install will try to automatically change the Ubuntu locale to match the locale of your Windows install.</span></span>  <span data-ttu-id="a1f0b-151">如果您不想要此行為, 您可以執行此命令, 以在安裝完成後變更 Ubuntu 地區設定。</span><span class="sxs-lookup"><span data-stu-id="a1f0b-151">If you do not want this behavior you can run this command to change the Ubuntu locale after install completes.</span></span>  <span data-ttu-id="a1f0b-152">您必須重新開機 bash, 這種變更才會生效。</span><span class="sxs-lookup"><span data-stu-id="a1f0b-152">You will have to relaunch bash.exe for this change to take effect.</span></span>

<span data-ttu-id="a1f0b-153">下列範例會將地區設定變更為 en-us:</span><span class="sxs-lookup"><span data-stu-id="a1f0b-153">The below example changes to locale to en-US:</span></span>
``` BASH
sudo update-locale LANG=en_US.UTF8
```

### <a name="installation-issues-after-windows-system-restore"></a><span data-ttu-id="a1f0b-154">Windows 系統還原後的安裝問題</span><span class="sxs-lookup"><span data-stu-id="a1f0b-154">Installation issues after Windows system restore</span></span>
1.  <span data-ttu-id="a1f0b-155">`%windir%\System32\Tasks\Microsoft\Windows\Windows Subsystem for Linux`刪除資料夾。</span><span class="sxs-lookup"><span data-stu-id="a1f0b-155">Delete the `%windir%\System32\Tasks\Microsoft\Windows\Windows Subsystem for Linux` folder.</span></span> <br/>
  <span data-ttu-id="a1f0b-156">**注意：如果您的選用功能已完整安裝且正常運作, 請不要這麼做。**</span><span class="sxs-lookup"><span data-stu-id="a1f0b-156">**Note: Do not do this if your optional feature is fully installed and working.**</span></span>
2.  <span data-ttu-id="a1f0b-157">啟用 WSL 選用功能 (如果尚未這麼做)</span><span class="sxs-lookup"><span data-stu-id="a1f0b-157">Enable the WSL optional feature (if not already)</span></span>
3.  <span data-ttu-id="a1f0b-158">重新開機</span><span class="sxs-lookup"><span data-stu-id="a1f0b-158">Reboot</span></span>
4.  <span data-ttu-id="a1f0b-159">lxrun/uninstall/full</span><span class="sxs-lookup"><span data-stu-id="a1f0b-159">lxrun /uninstall /full</span></span>
5.  <span data-ttu-id="a1f0b-160">安裝 bash</span><span class="sxs-lookup"><span data-stu-id="a1f0b-160">Install bash</span></span>

### <a name="no-internet-access-in-wsl"></a><span data-ttu-id="a1f0b-161">WSL 中沒有網際網路存取</span><span class="sxs-lookup"><span data-stu-id="a1f0b-161">No internet access in WSL</span></span>
<span data-ttu-id="a1f0b-162">某些使用者回報了在 WSL 中封鎖網際網路存取的特定防火牆應用程式問題。</span><span class="sxs-lookup"><span data-stu-id="a1f0b-162">Some users have reported issues with specific firewall applications blocking internet access in WSL.</span></span>  <span data-ttu-id="a1f0b-163">回報的防火牆如下:</span><span class="sxs-lookup"><span data-stu-id="a1f0b-163">The firewalls reported are:</span></span>

1. <span data-ttu-id="a1f0b-164">Kaspersky</span><span class="sxs-lookup"><span data-stu-id="a1f0b-164">Kaspersky</span></span>
1. <span data-ttu-id="a1f0b-165">AVG</span><span class="sxs-lookup"><span data-stu-id="a1f0b-165">AVG</span></span>
1. <span data-ttu-id="a1f0b-166">Avast</span><span class="sxs-lookup"><span data-stu-id="a1f0b-166">Avast</span></span>

<span data-ttu-id="a1f0b-167">在某些情況下, 關閉防火牆可讓您存取。</span><span class="sxs-lookup"><span data-stu-id="a1f0b-167">In some cases turning off the firewall allows for access.</span></span>  <span data-ttu-id="a1f0b-168">在某些情況下, 只安裝防火牆會顯示封鎖存取。</span><span class="sxs-lookup"><span data-stu-id="a1f0b-168">In some cases simply having the firewall installed looks to block access.</span></span>

### <a name="permission-denied-error-when-using-ping"></a><span data-ttu-id="a1f0b-169">使用 ping 時發生許可權拒絕錯誤</span><span class="sxs-lookup"><span data-stu-id="a1f0b-169">Permission Denied error when using ping</span></span>
#### <a name="anniversary-updatehttpsmsdnmicrosoftcomen-uscommandlinewslreleasenotesbuild-14388-to-windows-10-anniversary-update"></a>[<span data-ttu-id="a1f0b-170">年度更新</span><span class="sxs-lookup"><span data-stu-id="a1f0b-170">Anniversary Update</span></span>](https://msdn.microsoft.com/en-us/commandline/wsl/release_notes#build-14388-to-windows-10-anniversary-update) 

<span data-ttu-id="a1f0b-171">需要 Windows 中的系統管理員許可權, 才能在 WSL 中執行 ping。</span><span class="sxs-lookup"><span data-stu-id="a1f0b-171">Administrator privileges in Windows are required to run ping in WSL.</span></span>  <span data-ttu-id="a1f0b-172">若要執行 ping, 請以系統管理員身分在 Windows 上的 Ubuntu 上執行 Bash, 或從具有系統管理員許可權的 CMD/PowerShell 提示字元執行 bash。</span><span class="sxs-lookup"><span data-stu-id="a1f0b-172">To run ping, run Bash on Ubuntu on Windows as an administrator, or run bash.exe from a CMD/PowerShell prompt with administrator privileges.</span></span>

#### <a name="build-14926httpsmsdnmicrosoftcomen-uscommandlinewslreleasenotesbuild-14926"></a>[<span data-ttu-id="a1f0b-173">組建 14926 +</span><span class="sxs-lookup"><span data-stu-id="a1f0b-173">Build 14926+</span></span>](https://msdn.microsoft.com/en-us/commandline/wsl/release_notes#build-14926)
  <span data-ttu-id="a1f0b-174">不再需要系統管理員許可權。</span><span class="sxs-lookup"><span data-stu-id="a1f0b-174">Administrator privileges no longer required.</span></span>

### <a name="bash-is-hung"></a><span data-ttu-id="a1f0b-175">Bash 已停止回應</span><span class="sxs-lookup"><span data-stu-id="a1f0b-175">Bash is hung</span></span>
<span data-ttu-id="a1f0b-176">當您使用 bash 時, 您會發現 bash 已停止回應 (或鎖死), 而且沒有回應輸入, 請收集和報告記憶體傾印, 以協助我們診斷問題。</span><span class="sxs-lookup"><span data-stu-id="a1f0b-176">If while working with bash, you find that bash is hung (or deadlocked) and not responding to inputs, help us diagnose the issue by collecting and reporting a memory dump.</span></span> <span data-ttu-id="a1f0b-177">請注意, 這些步驟將會損毀您的系統。</span><span class="sxs-lookup"><span data-stu-id="a1f0b-177">Note that these steps will crash your system.</span></span> <span data-ttu-id="a1f0b-178">如果您不熟悉該作業, 或在執行此動作之前儲存您的工作, 請不要這麼做。</span><span class="sxs-lookup"><span data-stu-id="a1f0b-178">Do not do this if you are not comfortable with that or save your work prior to doing this.</span></span>  <br/>
<span data-ttu-id="a1f0b-179">若要收集記憶體傾印:</span><span class="sxs-lookup"><span data-stu-id="a1f0b-179">To collect a memory dump:</span></span>
1. <span data-ttu-id="a1f0b-180">將記憶體傾印類型變更為「完成記憶體傾印」。</span><span class="sxs-lookup"><span data-stu-id="a1f0b-180">Change the memory dump type to "complete memory dump".</span></span> <span data-ttu-id="a1f0b-181">變更傾印類型時, 請記下您目前的類型。</span><span class="sxs-lookup"><span data-stu-id="a1f0b-181">While changing the dump type, take a note of your current type.</span></span>
2. <span data-ttu-id="a1f0b-182">使用 [使用鍵盤控制項設定當機] 的[步驟](https://blogs.technet.microsoft.com/askpfeplat/2015/04/05/how-to-force-a-diagnostic-memory-dump-when-a-computer-hangs/)。</span><span class="sxs-lookup"><span data-stu-id="a1f0b-182">Use the [steps](https://blogs.technet.microsoft.com/askpfeplat/2015/04/05/how-to-force-a-diagnostic-memory-dump-when-a-computer-hangs/) to configure crash using keyboard control.</span></span>
3. <span data-ttu-id="a1f0b-183">重現停止回應或鎖死。</span><span class="sxs-lookup"><span data-stu-id="a1f0b-183">Repro the hang or deadlock.</span></span>
4. <span data-ttu-id="a1f0b-184">使用 (2) 中的機碼序列來損毀系統。</span><span class="sxs-lookup"><span data-stu-id="a1f0b-184">Crash the system using the key sequence from (2).</span></span>
5. <span data-ttu-id="a1f0b-185">系統會損毀並收集記憶體傾印。</span><span class="sxs-lookup"><span data-stu-id="a1f0b-185">The system will crash and collect the memory dump.</span></span>
6. <span data-ttu-id="a1f0b-186">系統重新開機之後, 請將記憶體 dmp 回報給secure@microsoft.com。</span><span class="sxs-lookup"><span data-stu-id="a1f0b-186">Once the system reboots, report the memory.dmp to secure@microsoft.com.</span></span> <span data-ttu-id="a1f0b-187">傾印檔案的預設位置是%SystemRoot%\memory.dmp 或 C:\Windows\memory.dmp (如果 C: 是系統磁片磁碟機)。</span><span class="sxs-lookup"><span data-stu-id="a1f0b-187">The default location of the dump file is %SystemRoot%\memory.dmp or C:\Windows\memory.dmp if C: is the system drive.</span></span> <span data-ttu-id="a1f0b-188">在電子郵件中, 請注意, 傾印適用于 Windows 小組的 WSL 或 Bash。</span><span class="sxs-lookup"><span data-stu-id="a1f0b-188">In the email, note that the dump is for the WSL or Bash on Windows team.</span></span>
7. <span data-ttu-id="a1f0b-189">將記憶體傾印類型還原為原始設定。</span><span class="sxs-lookup"><span data-stu-id="a1f0b-189">Restore the memory dump type to the original setting.</span></span>

### <a name="check-your-build-number"></a><span data-ttu-id="a1f0b-190">檢查您的組建編號</span><span class="sxs-lookup"><span data-stu-id="a1f0b-190">Check your build number</span></span>

<span data-ttu-id="a1f0b-191">若要尋找您電腦的架構和 Windows 組建編號, 請開啟</span><span class="sxs-lookup"><span data-stu-id="a1f0b-191">To find your PC's architecture and Windows build number, open</span></span>  
<span data-ttu-id="a1f0b-192">**設定** > **系統**關於 > </span><span class="sxs-lookup"><span data-stu-id="a1f0b-192">**Settings** > **System** > **About**</span></span>

<span data-ttu-id="a1f0b-193">尋找 [**作業系統組建**] 和 [**系統類型**] 欄位。</span><span class="sxs-lookup"><span data-stu-id="a1f0b-193">Look for the **OS Build** and **System Type** fields.</span></span>  
    <span data-ttu-id="a1f0b-194">![[組建] 和 [系統類型] 欄位的螢幕擷取畫面](media/system.png)</span><span class="sxs-lookup"><span data-stu-id="a1f0b-194">![Screenshot of Build and System Type fields](media/system.png)</span></span> 


<span data-ttu-id="a1f0b-195">若要尋找您的 Windows Server 組建編號, 請在 PowerShell 中執行下列程式碼:</span><span class="sxs-lookup"><span data-stu-id="a1f0b-195">To find your Windows Server build number, run the following in PowerShell:</span></span>  
``` PowerShell
systeminfo | Select-String "^OS Name","^OS Version"
```

### <a name="confirm-wsl-is-enabled"></a><span data-ttu-id="a1f0b-196">確認已啟用 WSL</span><span class="sxs-lookup"><span data-stu-id="a1f0b-196">Confirm WSL is enabled</span></span>
<span data-ttu-id="a1f0b-197">您可以在 PowerShell 中執行下列程式, 確認已啟用適用于 Linux 的 Windows 子系統:</span><span class="sxs-lookup"><span data-stu-id="a1f0b-197">You can confirm that the Windows Subsystem for Linux is enabled by running the following in PowerShell:</span></span>  
``` PowerShell
Get-WindowsOptionalFeature -Online -FeatureName Microsoft-Windows-Subsystem-Linux
```

### <a name="openssh-server-connection-issues"></a><span data-ttu-id="a1f0b-198">OpenSSH-伺服器連接問題</span><span class="sxs-lookup"><span data-stu-id="a1f0b-198">OpenSSH-Server connection issues</span></span>
<span data-ttu-id="a1f0b-199">嘗試連接 SSH 伺服器失敗, 發生下列錯誤:「連接已由127.0.0.1 埠22關閉」。</span><span class="sxs-lookup"><span data-stu-id="a1f0b-199">Trying to connect your SSH server is failed with the following error: "Connection closed by 127.0.0.1 port 22".</span></span>
1. <span data-ttu-id="a1f0b-200">請確定您的 OpenSSH 伺服器正在執行:</span><span class="sxs-lookup"><span data-stu-id="a1f0b-200">Make sure your OpenSSH Server is running:</span></span>
   ``` BASH
   sudo service ssh status
   ```
   <span data-ttu-id="a1f0b-201">您已遵循此教學課程: https://help.ubuntu.com/lts/serverguide/openssh-server.html.en</span><span class="sxs-lookup"><span data-stu-id="a1f0b-201">and you've followed this tutorial: https://help.ubuntu.com/lts/serverguide/openssh-server.html.en</span></span>
2. <span data-ttu-id="a1f0b-202">停止 sshd 服務並以 debug 模式啟動 sshd:</span><span class="sxs-lookup"><span data-stu-id="a1f0b-202">Stop the sshd service and start sshd in debug mode:</span></span>
   ``` BASH
   sudo service ssh stop
   sudo /usr/sbin/sshd -d
   ```
3. <span data-ttu-id="a1f0b-203">檢查開機記錄, 並確認 HostKeys 可供使用, 而且您看不到記錄訊息, 例如:</span><span class="sxs-lookup"><span data-stu-id="a1f0b-203">Check the startup logs and make sure HostKeys are available and you don't see log messages such as:</span></span>
   ```
   debug1: sshd version OpenSSH_7.2, OpenSSL 1.0.2g  1 Mar 2016
   debug1: key_load_private: incorrect passphrase supplied to decrypt private key
   debug1: key_load_public: No such file or directory
   Could not load host key: /etc/ssh/ssh_host_rsa_key
   debug1: key_load_private: No such file or directory
   debug1: key_load_public: No such file or directory
   Could not load host key: /etc/ssh/ssh_host_dsa_key
   debug1: key_load_private: No such file or directory
   debug1: key_load_public: No such file or directory
   Could not load host key: /etc/ssh/ssh_host_ecdsa_key
   debug1: key_load_private: No such file or directory
   debug1: key_load_public: No such file or directory
   Could not load host key: /etc/ssh/ssh_host_ed25519_key
   ```

<span data-ttu-id="a1f0b-204">如果您看到這類訊息, 而`/etc/ssh/`中遺漏了金鑰, 您就必須重新產生金鑰, 或只是清除 & 安裝 openssh-伺服器:</span><span class="sxs-lookup"><span data-stu-id="a1f0b-204">If you do see such messages and the keys are missing under `/etc/ssh/`, you will have to regenerate the keys or just purge&install openssh-server:</span></span>
```BASH
sudo apt-get purge openssh-server
sudo apt-get install openssh-server
```

